#title		"MML Test"
#include	"test1.mml"

#Code		"../../bin/nsd.bin"

#BGM		10
#SE			2

#OffsetPCM	$C000

DPCM{
	b1,	"../dmc/bd.dmc",14,0,64
	c2,	"../dmc/bd.dmc",15,0,64
	d2,	"../dmc/sd.dmc",15,0,64
	e2,	"../dmc/sd.dmc",14,0,64
	f+2,"../dmc/hhc.dmc",15,0,64
	a+2,"../dmc/hho.dmc",15,0,64
	c+3,"../dmc/cymbal.dmc",15,0,64

	f2,	"../dmc/tom.dmc",10,0,64
	g2,	"../dmc/tom.dmc",11,0,64
	a2,	"../dmc/tom.dmc",12,0,64
	b2,	"../dmc/tom.dmc",13,0,64
	c3,	"../dmc/tom.dmc",14,0,64
	d3,	"../dmc/tom.dmc",15,0,64
}

//	frequency envelop "Volume table"
Envelop(0){		8 10 12 13 14 15 D10 14 D3 13 D1 12 11 L 10 10 9 9 8 8 9 9 R 8 8 7 7 6 6 5 5 L 4 4 3 3 2 2 3 3 	}
Envelop(10){	15 12 8 6 5 4 3 3 2 D3 1 D7 0	}

//	frequency envelop "LFO"
Envelop(100){	L 0 1 2 3 3 2 1 0  -1 -2 -3 -3 -2 -1 	}

//	Voice envelop
Envelop(200){	L 2 1 R 2 	}
Envelop(210){	1 0	}

//	for Mote Envelop "Major code"
Envelop(10000000){	L 0 4 7 }

Envelop(300){	4 3 2 1 0}


Sub(1000000){	l4 o5 cc+ dd+ e ff+ gg+ aa+ b > cc+ dd+ e1	}

bgm(9){
	TR3	v15	P20,1,-7,-24 Em100	c1	c1	P20,1,7,24	c1	c1
}

bgm(7){
	TR1	l8 c.d.e f.g.a b.>c.d e.f.g
	TR3	l2 c     f     b      e  
}

Envelop(800){	15 14 13 12 11 10 R 8 6 4 2 }

bgm(8){
	t60 Ev800	K{+r}	l8	cr cr= cr+ cr-	K{=r}	cr cr+ cr= cr-	K{-r}	cr cr= cr- cr+
}

BGM(6){
	TR1	l1 o5 v15 u2	E@200 Ev0 Em100 En10000000 	c d e f g a b > En*	Em*	Ev* @2	c1,2
	TR4	Ev10	S1000000
}

bgm(5){
	TR1	y$400F,10	u1-4.+%1		|: s9,7	c2	s9,15	^2 s0,8	\ d1  :|  e1 :| f1 l8  |: [2 c ] \ [2 d ] :| [2 e ] c1
}

//----------------------------------------------
//	W.A.Mozart	"Ave Verum Corpus"	K.v.618		※弦楽器パートだけ！！
//----------------------------------------------

Envelop(1){	4 6 7 8 9 10 11 12 13 14 15 D2 14 D2 13 12 L 11 11 10 D2 11 11 12 D2 R 10 9 8 7 6 5 L 4 4 3 D1 2 2 3 D1 }

Envelop(101){	0 D12 L 0 2 4 4 2 0 -2 -4 -4 -2 	}

Envelop(201){	0 0 1	}

bgm(0){
	TR1	o5 l4 q3 v11	Ev1	Em101	E@201	t60	K{+fc}	
	TR2	o5 l4 q3 v8		Ev1	Em101	E@201		K{+fc}	
	TR3	o4 l4 q1			Em101	E@201		K{+fc}	

	TR1		 d&"a&d&e	| f&d&f&g	| a&f `d&f	| a&g+&g g	| g&b&a&g	| g&f	f&a
	TR2		"a2.&c4		| d&"a&d&e	| f2.	d	| e2 e2		| e&g&f&e	| e&d	d2
	TR3		 f2.&a4		| a&f&a a	| a2	a2	| b2 b2		| a2	a2	| a2	a2

	TR1		a&e	e&a	| a&>f g<g	|	g2&f2	| e&c	c&e		| e&>e c&<a	|	a&g+	g&e
	TR2		c2.	e	| f&>d e<e	|	e2&d2	| c&<a	a&>c	| c2.	c	|	c&d		d2
	TR3		a2.>c	| d2<	a2	|	a1		| a&e	e&a		| a2>	e2	|	e2		e2

	TR1		e&>e  d&<b	| b&a	aa&	|>d	d2	d		| ^&c<b&a	| "b&a	"b&g+	| "a a&>	e2
	TR2		"b2.	g+	| g+&a	a2	| r- <a&g+&>g+	| a2f2		| e2	d2		| c2.	e&
	TR3		e2.&	d	| d&c	c2	| r  <a&g+& b>	| e2 d&c<	| b2.	 b		| a2.>	c

	TR1		^&d& e&f<	| a2-8 `c8&b4.&a8	| a&e	c&e		| a&e	c&a	| a&b-	b-b-	| b-&>d&	c=&<b-
	TR2		a	a2	a	| c&e	d&e			| c2	"a&c	| e2.	e	| e2	e2		| e2.		e
	TR3		^&d&c&"b	| e2<	g+2			| a2	e&a	>	| c2.	c	| c2.	c=		| c=&<b-&	a&g

	TR1		b-&a	a&<a	| g&>d	g&"b	| c b-&	a&g		| g2	f=8&e8& f=	| e  c&d& e
	TR2		e&f=	f=2		| d2.	g		| g&f=&	e e		| e2	d8&c8&  d	| c <a&b&>c
	TR3		g&a		a2		| b2.	`d		| g&b&	e&>c	| c2&	d&<b		| e a2	a	

	TR1		f2.	f	| f&e& d&g	| g2.	g		| g&f&e&a	| a2.	a
	TR2		d2.	d	| d&c&"b&d	| e2.	e		| e&d&c&f	| f2.	f
	TR3		a2	d2	| b2.	b	| b&a&	g&>c	| c2.	c	| c&<b&a&>d

	TR1		a&g&a&b	| f2 e4.f8	|	g g2 g&	|>d d2 d		| ^ d&d+ d+&	| e&"b&c&d
	TR2		f&g&f&e	| d2	c2	|	d2	r-2	| r- "b&c=&f&	| g "b-&c=&f	| "b&d&c&"b
	TR3		d2.	d<	| a2	a2	|	d2	r-2	| r- b&>c=&f&	| g "b-&c=&f	| "b&d&c&<b

	TR1		c& <b8&a8 `d4&g4	| f2&	e2	| d&f	a2	| ^& d	g2	| f2 l32 [8 :	t_-2 f& t_-2 e&	] t_-4 d& t_-8 e,32 t40	|	d1
	TR2		e&  d8&c8 d2		| d2&	c2	| d2&	f2	| ^&"b	e2	| ^& d2& c	|	d1
	TR3		a2.			g		| a2&	g2	| f2	ra&	| `d2.	b	| a2	g2	|	f1

}




//A-Dur Key Signature test
//そして、D-Durに移調するテスト
//そのまま、B-Durにいってみよう！　最後は、 rit もしてみる。
//かつ、いきなり、TR3を指定するテスト
bgm(1){
	TR3	K{+fcg} t120 u16. l8	<a4,8.	b>cdefg a1,2..
		K{=g}				d4,8.	efgab>c d1,2..<
		K{=fc-be}			"b4,8.	cdef t_-10 g t_-10 a& t_-20 b1,2
	TR5	o2l16	`c+8f+f+	d8f+f+	c8f+f+	d8f+f+	|	c8f+f+	d8f+f+	c8f+f+	>d12<b12f12
				`c+8f+f+	d8f+f+	c8f+f+	d8f+f+	|	c8f+f+	d8f+f+	c8f+f+	d8f+f+
				`c+8f+f+	d8f+f+	c8f+f+	d8f+f+	|	>c+2	t120	c48 d6-48 <a48 b6-48 f48 g6-48
}


/*
エンベロープの実装は、まず、音源ドライバーに実装されている機能を全て、
ＭＭＬコンパイラでコンパイルできるようになってから、実装予定ですよ。

と、範囲コメントを書く、テスト。
*/

Sub(100){
	Ev0 u16. l8	c4,8.. defgab b%1&> c1-%1,2..
}


//Cent base の Detune
bgm(2){
	TR1		t83			S100
	TR2	r-16. ((((((D-2	S100
}

//Register base の Detune
bgm(3){
	TR1		t83			S100
	TR2	r-16. ((((((D%1	S100
}

//移調テスト
bgm(4){
	TR1	t180	l4	_-4 c __1 c __1 c __1 c __1 c _12 c
}

se(0){
	TR1	t255	v11	Ev1	Em101	E@201	l4	c.d.e f.g.a 
}

se(1){
	TR2	t255	v15	Ev10	[8	c4	]
}

