<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<meta http-equiv='Content-Type' content='text/html;charset=Shift_JIS'>
<meta http-equiv='Content-Style-Type' content='text/css'>
<link rel="stylesheet" type="text/css" href="help.css">
<Title>MMLコンパイラ（nsc.exe）</Title>
</HEAD>
<BODY>

<div id='contents'>
<h1>NSDL（NES Sound Driver Library）</h1>
<h2>MMLコンパイラ（nsc.exe）</h2>

<div class='block'>
<h3>コマンドラインオプション（Command line option）</h3>
<p>
テキストで記述されたMMLファイルを、本音源ドライバーNSD.Lib用のデータに変換します。<br>
デフォルトでは何も出力しません。何かコマンドラインオプションを指定して下さい。<br>
</p>
<p>
アセンブリ言語で出力したファイルは、単体でオブジェクトファイルにアセンブル可能となります。<br>
ユーザー・アプリケーションのビルドの際に、そのオブジェクト・ファイルをリンクして下さい。<br>
</p>
<p>
また、NSF Music formarへのコンパイルも可能です。<br>
複数の曲に対応していますが、コンパイラで直接ＮＳＦを生成する場合、
実行コード、曲データ、⊿ＰＣＭデータ<strong>(未対応)</strong>の合計が32kByteまでとなります。<br>
<br>
</p>
<code><pre>
	nsc <var>-option</var> <var>MML-file name</var>
</pre></code>
<dl>
<dt>-h</dt><dd>Print the this help.</dd>
<dt>-a</dt><dd>Compile to assembly langage. (*.s) </dd>
<dt>-n</dt><dd>Compile to NSF music format. (*.nsf) </dd>
<dt>-l<var>filename</var></dt><dd>Set the filename of the rom code for NSF.</dd>
<dt>-fa<var>filename</var></dt><dd>Set the filename of the output assembly langage file.</dd>
<dt>-fn<var>filename</var></dt><dd>Set the filename of the output NSF music format.</dd>
</dl>
</div>

<div class='block'>
<h3>ＭＭＬ文法（Syntax of MML）</h3>
<h4><a href="mml.html#construction">全体の構文</a></h4>
<p>
MMLの構文は、`#'で始まる定義命令・疑似命令及び、<br>
データ（エンベロープパターン、シーケンスデータ）を記述する記述ブロックで構成されます。
</p>
<h4><a href="mml.html#envelop">エンベロープパターン</a></h4>
<p>
音色、音量、周波数、音程の推移パターンを定義します。<br>
</p>
<h4><a href="mml.html#sequence">シーケンスデータ</a></h4>
<p>
BGM,SE,サブルーチンの演奏パターンを定義します。<br>
</p>
</div>


<div class='block'>
<h3>アセンブリ言語ソースの仕様</h3>
<p>
</p>
<h4>曲データのシンボル（ラベル）</h4>
<p>
シンボルは、"<code>#label</code>"コマンドで指定した文字列に、"<code>BGM<var>番号</var></code>"の文字列が付与されます。<br>
このシンボルのポインタを引数に、<a href="func_nsd_play_bgm.html">nsd_play_bgm()関数</a>を呼び出すことで、その曲データが再生されます。<br>
曲データは、6502のメモリ空間にさえ存在していれば（バンクがセレクトされていれば）、どこに配置されていても再生可能です。<br>
</p>
<p>
例えば、<code>#label</code>コマンドで指定した文字列が"<var>_foo_</var>"で２番のＢＧＭデータのシンボル名は、<code>_foo_BGM2</code>となります。<br>
このシンボル名は、コンパイラが生成するアセンブリ言語ソースにて、自動で<code>.export</code>宣言されています。<br>
従って、ユーザーアプリケーション側からはこのシンボル名に対して、<br>
アセンブリ言語の場合は<code>.import</code>宣言、<br>
Ｃ言語の場合は<code>extern</code>宣言（"const char"型のグローバル変数として）することで、参照が可能になります。<br>
</p>
</div>

</div>

</BODY>
</HTML>
