<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<meta http-equiv='Content-Type' content='text/html;charset=Shift_JIS'>
<meta http-equiv='Content-Style-Type' content='text/css'>
<link rel="stylesheet" type="text/css" href="help.css">
<Title>ＭＭＬ文法</Title>
</HEAD>
<BODY>

<div id='contents'>
<h1>NSDL（NES Sound Driver Library）</h1>
<h2>ＭＭＬ文法</h2>


<div class='block'>
<h3><a name="construction">全体の構文（MML Construction）</a></h3>
<p>
MMLの全体的な構文は、`#'で始まる定義＆疑似命令及び、
データ（エンベロープパターン、シーケンスデータ）を記述する記述ブロックで構成されます。<br>
MMLコンパイラは、ASCIIコード0x00～0x20（改行、ＴＡＢ、スペース等）を無視します。<br>
</p>
<p>
定義命令の多くは、NSFへビルドする際にNSFヘッダーに設定されます。<br>
</p>

<table>
<caption>共通のコマンド</caption>
<tr><th>Command</th><th>Contens</th></tr>
<tr><td>#include	"<var>filename</var>"	</td><td>外部ファイルを呼び込みます。</td></tr>
<tr><td>#octaveReverse						</td><td>本コマンドを記述することで、相対オクターブの`&lt;'と`&gt;'を入れ替えます。</td></tr>
<tr><td>#bgm <var>n</var>					</td><td>BGMの曲数を設定します。（Default: <var>n</var> = 1）</td></tr>
<tr><td>#se  <var>n</var>					</td><td>SE の曲数を設定します。（Default: <var>n</var> = 0）</td></tr>
<tr><td>#offsetPCM	<var>address</var>		</td><td>⊿PCMを配置するアドレスを指定します。（Default: $10000(⊿PCM無し)）<br>
														シーケンスデータはこのコマンドで指定したアドレス-1の領域まで使えます。<br>
														NSF music formatでは、このアドレスからΔPCMを配置します。<br>
														アセンブリ言語ソースを出力する場合は、"#segmentPCM"コマンドで指定したセグメントについて
														リンカー"ld65.exe"のコンフィグファイルにて設定した実アドレス指定して下さい。</td></tr>
<tr><td>DPCM{<br> <var>Delta PCM define</var><br>}	</td>
	<td>⊿PCM定義の記述ブロックです。<br>
		⊿PCM定義の記述は、<a href="mml_dpcm.html">⊿PCM定義（Delta PCM define）</a>の項を参照ください。</td></tr>
<tr><td>FDSC(<var>n</var>){<br> <var>wave table</var><br>}	</td>
	<td>FDSのキャリア側の波形データ定義の記述ブロックです。<br>
		<strong>（開発中）</strong></td></tr>
<tr><td>FDSM(<var>n</var>){<br> <var>wave table</var><br>}	</td>
	<td>FDSのモジュレータ側の波形データ定義の記述ブロックです。<br>
		<strong>（開発中）</strong></td></tr>
<tr><td>VRC7(<var>n</var>){<br> <var>VRC7 define</var><br>}	</td>
	<td>VRC7ユーザー音色定義の記述ブロックです。<br>
		VRC7ユーザー音色定義の記述は、<a href="mml_vrc7.html">VRC7 ユーザー音色定義（VRC7 User Instrument define）</a>の項を参照ください。</td></tr>
<tr><td>N163(<var>n</var>){<br> <var>wave table</var><br>}	</td>
	<td>n163の波形データ定義の記述ブロックです。<br>
		<strong>（開発中）</strong></td></tr>
<tr><td>Envelop(<var>n</var>){<br> <var>Envelop data</var><br>}	</td>
	<td><var>n</var>番のエンベロープパターン定義の記述ブロックです。<br>
		エンベロープパターンの記述は、<a href="mml_envelope.html">エンベロープパターン（Envelop pattern）</a>の項を参照ください。</td></tr>
<tr><td>Sub(<var>n</var>){<br> <var>Sequence data</var><br>}	</td>
	<td><var>n</var>番のサブルーチンの記述ブロックです。<br>
		シーケンスパターンの記述は、<a href="mml_sequence.html">シーケンスデータ（Sequence data）</a>の項を参照ください。</td></tr>
<tr><td>BGM(<var>n</var>){<br> <var>Sequence data</var><br>}	</td>
	<td><var>n</var>番目のBGMのシーケンスの記述ブロックです。<br>
		シーケンスパターンの記述は、<a href="mml_sequence.html">シーケンスデータ（Sequence data）</a>の項を参照ください。<br>
		番号は0からカウントします。</td></tr>
<tr><td>SE(<var>n</var>){<br> <var>Sequence data</var><br>}		</td>
	<td><var>n</var>番目のSE のシーケンスの記述ブロックです。<br>
		シーケンスパターンの記述は、<a href="mml_sequence.html">シーケンスデータ（Sequence data）</a>の項を参照ください。<br>
		番号は0からカウントします。</td></tr>
<tr><td>$<var>name</var>{<br> <var>Sequence data</var><br>}
	</td><td>シーケンス用のマクロ定義です。<strong>（未実装）</strong></td></tr>
<tr><td>;<span style="color:green;">comments</span>		</td><td>１行コメントです。改行までの記述を無視します。<br>（各記述ブロック内でも有効です）</td></tr>
<tr><td>//<span style="color:green;">comments</span>	</td><td>１行コメントです。改行までの記述を無視します。<br>（各記述ブロック内でも有効です）</td></tr>
<tr><td>/*<span style="color:green;">comments</span>*/	</td><td>範囲コメントです。 /* と */ の間の記述を無視します。<br>（各記述ブロック内でも有効です）</td></tr>
</table>
<br>

<table>
<caption>NSF music formatを出力する際に有効なコマンド</caption>
<tr><th>Command</th><th>Contens</th></tr>
<tr><td>#code		"<var>name</var>"		</td><td>リンクするＮＳＦ用のＲＯＭコードを指定します。（Default: name = `nsd.bin'）<br>
													コンパイルオプション`-l'でROMコードの指定がある場合は、コンパイルオプションを優先します。</td></tr>
<tr><td>#title		"<var>strings</var>"	</td><td>タイトル名を設定します。NSFビルド時にヘッダーに埋め込まれます。</td></tr>
<tr><td>#composer	"<var>strings</var>"	</td><td>作曲者を設定します。NSFビルド時にヘッダーに埋め込まれます。</td></tr>
<tr><td>#copyright	"<var>strings</var>"	</td><td>著作権者を設定します。NSFビルド時にヘッダーに埋め込まれます。</td></tr>
</table>
<br>

<table>
<caption>アセンブリ言語ソースを出力する際に有効なコマンド</caption>
<tr><th>Command</th><th>Contens</th></tr>
<tr><td>#segment	"<var>name</var>"<br>
		#segmentSEQ	"<var>name</var>"		</td><td>⊿PCM以外のセグメントを指定します。（Default: name = `RODATA'）</td></tr>
<tr><td>#segmentPCM	"<var>name</var>"		</td><td>⊿PCMのセグメントを指定します。（Default: name = `PCMDATA'）</td></tr>
<tr><td>#label		"<var>name</var>"		</td><td>ラベル名（シンボル名）の先頭に付与する文字列を指定します。（Default: name = `_nsd_'）<br>
								Ｃコンパイラは、Ｃ言語で記述されたラベル（シンボル）名の先頭に`_'を付加します。<br>
								従い、Ｃ言語から曲データを参照する場合、MML側で設定するラベル名は先頭に`_'を追加してください。</td></tr>
</table>

</div>

</div>

</BODY>
</HTML>
