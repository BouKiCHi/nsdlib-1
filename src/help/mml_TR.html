<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<meta http-equiv='Content-Type' content='text/html;charset=Shift_JIS'>
<meta http-equiv='Content-Style-Type' content='text/css'>
<link rel="stylesheet" type="text/css" href="help.css">
<Title>MML reference: TR</Title>
</HEAD>
<BODY>

<!-- header start -->
<div id='header'>
<h1>NSDL（NES Sound Driver Library）</h1>
<a href="index.html">トップ</a>＼
<a href="usage.html">使い方</a>＼
<a href="usage_nsc.html">MMLコンパイラ</a>＼
<a href="mml.html">MML文法</a>＼
<a href="mml_sequence.html">MMLシーケンス</a>＼
</div>

<!-- contents start -->
<div id='contents'>
<h2>MML reference: TR</h2>

<!-- ──────────────── -->
<div class='block'>
<h3>定義（Define）</h3>
<code><pre>
        TR<var>track</var> <span style="color:blue;">(</span>,<var>track2</var>,...<span style="color:blue;">)</span>
</pre></code>
</div>

<!-- ──────────────── -->
<div class='block'>
<h3>引数（Inputs）</h3>

<p>
トラック番号を指定します。<br>
カンマ（,）で区切ることにより、複数のトラックを指定可能です。<br>
</p>
<p>
<var>track</var>番号は、BGM記述ブロックとSE記述ブロックで値が異なります。<br>
</p>

<h4>BGM記述ブロック</h4>
<p>
リンクするライブラリ(*.lib)、ＮＳＦ用コード（*.bin）によって各トラックに割り当てられる音源が異なります。<br>
</p>

<table>
<caption>全共通</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR1		</td><td>APU(2A03) パルス波 ch1	（Default）</td></tr>
<tr><td>TR2		</td><td>APU(2A03) パルス波 ch2	</td></tr>
<tr><td>TR3		</td><td>APU(2A03) 三角波		</td></tr>
<tr><td>TR4		</td><td>APU(2A03) ノイズ		</td></tr>
<tr><td>TR5		</td><td>APU(2A03) ⊿ＰＣＭ		</td></tr>
</table>
<br>

<table>
<caption>nsd_fds.lib / nsd_fds.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>FDS（ディスクシステム音源）</td></tr>
</table>
<br>

<table>
<caption>nsd_vrc6.lib / nsd_vrc6.bin</caption>
<tr><th>トラック</th><th>音源				</th></tr>
<tr><td>TR6		</td><td>VRC6 パルス波 ch1	</td></tr>
<tr><td>TR7		</td><td>VRC6 パルス波 ch2	</td></tr>
<tr><td>TR8		</td><td>VRC6 鋸波			</td></tr>
</table>
<br>

<table>
<caption>nsd_vrc7.lib / nsd_vrc7.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>VRC7（FM音源） ch1	</td></tr>
<tr><td>TR7		</td><td>VRC7（FM音源） ch2	</td></tr>
<tr><td>TR8		</td><td>VRC7（FM音源） ch3	</td></tr>
<tr><td>TR9		</td><td>VRC7（FM音源） ch4	</td></tr>
<tr><td>TR10	</td><td>VRC7（FM音源） ch5	</td></tr>
<tr><td>TR11	</td><td>VRC7（FM音源） ch6	</td></tr>
</table>
<br>

<table>
<caption>nsd_mmc5.lib / nsd_mmc5.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>MMC5 パルス波 ch1	</td></tr>
<tr><td>TR7		</td><td>MMC5 パルス波 ch2	</td></tr>
</table>
<br>

<table>
<caption>nsd_n163.lib / nsd_n163.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>N163（波形メモリ音源） ch8</td></tr>
<tr><td>TR7		</td><td>N163（波形メモリ音源） ch7</td></tr>
<tr><td>TR8		</td><td>N163（波形メモリ音源） ch6</td></tr>
<tr><td>TR9		</td><td>N163（波形メモリ音源） ch5</td></tr>
<tr><td>TR10	</td><td>N163（波形メモリ音源） ch4</td></tr>
<tr><td>TR11	</td><td>N163（波形メモリ音源） ch3</td></tr>
<tr><td>TR12	</td><td>N163（波形メモリ音源） ch2</td></tr>
<tr><td>TR13	</td><td>N163（波形メモリ音源） ch1</td></tr>
</table>
<br>

<table>
<caption>nsd_s5b.lib / nsd_s5b.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>Sunsoft 5B ch1		</td></tr>
<tr><td>TR7		</td><td>Sunsoft 5B ch2		</td></tr>
<tr><td>TR8		</td><td>Sunsoft 5B ch3		</td></tr>
</table>
<br>

<table>
<caption>nsd_all.bin </caption>
<tr><th>トラック</th><th>音源						</th></tr>
<tr><td>TR6		</td><td>VRC6 パルス波 ch1			</td></tr>
<tr><td>TR7		</td><td>VRC6 パルス波 ch2			</td></tr>
<tr><td>TR8		</td><td>VRC6 鋸波					</td></tr>
<tr><td>TR9		</td><td>VRC7（FM音源） ch1			</td></tr>
<tr><td>TR10	</td><td>VRC7（FM音源） ch2			</td></tr>
<tr><td>TR11	</td><td>VRC7（FM音源） ch3			</td></tr>
<tr><td>TR12	</td><td>VRC7（FM音源） ch4			</td></tr>
<tr><td>TR13	</td><td>VRC7（FM音源） ch5			</td></tr>
<tr><td>TR14	</td><td>VRC7（FM音源） ch6			</td></tr>
<tr><td>TR15	</td><td>MMC5 パルス波 ch1			</td></tr>
<tr><td>TR16	</td><td>MMC5 パルス波 ch2			</td></tr>
<tr><td>TR17	</td><td>N163（波形メモリ音源） ch8	</td></tr>
<tr><td>TR18	</td><td>N163（波形メモリ音源） ch7	</td></tr>
<tr><td>TR19	</td><td>N163（波形メモリ音源） ch6	</td></tr>
<tr><td>TR20	</td><td>N163（波形メモリ音源） ch5	</td></tr>
<tr><td>TR21	</td><td>N163（波形メモリ音源） ch4	</td></tr>
<tr><td>TR22	</td><td>N163（波形メモリ音源） ch3	</td></tr>
<tr><td>TR23	</td><td>N163（波形メモリ音源） ch2	</td></tr>
<tr><td>TR24	</td><td>N163（波形メモリ音源） ch1	</td></tr>
<tr><td>TR25	</td><td>Sunsoft 5B ch1				</td></tr>
<tr><td>TR26	</td><td>Sunsoft 5B ch2				</td></tr>
<tr><td>TR27	</td><td>Sunsoft 5B ch3				</td></tr>
<tr><td>TR28	</td><td>制御用トラックです（音符は発音しません）。<br>曲全体のコマンド（テンポや、VRC7, n163の音色設定等）を記述できます。</td></tr>
</table>

<table>
<caption>nsd_all2.bin </caption>
<tr><th>トラック</th><th>音源						</th></tr>
<tr><td>TR6		</td><td>VRC6 パルス波 ch1			</td></tr>
<tr><td>TR7		</td><td>VRC6 パルス波 ch1			</td></tr>
<tr><td>TR8		</td><td>VRC6 パルス波 ch2			</td></tr>
<tr><td>TR9		</td><td>VRC6 鋸波					</td></tr>
<tr><td>TR10		</td><td>VRC7（FM音源） ch1			</td></tr>
<tr><td>TR11	</td><td>VRC7（FM音源） ch2			</td></tr>
<tr><td>TR12	</td><td>VRC7（FM音源） ch3			</td></tr>
<tr><td>TR13	</td><td>VRC7（FM音源） ch4			</td></tr>
<tr><td>TR14	</td><td>VRC7（FM音源） ch5			</td></tr>
<tr><td>TR15	</td><td>VRC7（FM音源） ch6			</td></tr>
<tr><td>TR16	</td><td>MMC5 パルス波 ch1			</td></tr>
<tr><td>TR17	</td><td>MMC5 パルス波 ch2			</td></tr>
<tr><td>TR18	</td><td>N163（波形メモリ音源） ch8	</td></tr>
<tr><td>TR19	</td><td>N163（波形メモリ音源） ch7	</td></tr>
<tr><td>TR20	</td><td>N163（波形メモリ音源） ch6	</td></tr>
<tr><td>TR21	</td><td>N163（波形メモリ音源） ch5	</td></tr>
<tr><td>TR22	</td><td>N163（波形メモリ音源） ch4	</td></tr>
<tr><td>TR23	</td><td>N163（波形メモリ音源） ch3	</td></tr>
<tr><td>TR24	</td><td>N163（波形メモリ音源） ch2	</td></tr>
<tr><td>TR25	</td><td>N163（波形メモリ音源） ch1	</td></tr>
<tr><td>TR26	</td><td>Sunsoft 5B ch1				</td></tr>
<tr><td>TR27	</td><td>Sunsoft 5B ch2				</td></tr>
<tr><td>TR28	</td><td>Sunsoft 5B ch3				</td></tr>
<tr><td>TR29	</td><td>制御用トラックです（音符は発音しません）。<br>曲全体のコマンド（テンポや、VRC7, n163の音色設定等）を記述できます。</td></tr>
</table>
<p>
 ※ "nsd_all.bin"及び、"nsd_all2.bin"は、FDS以外の全ての拡張音源に対応したコードですが、
リソースの多くを音源ドライバーが使ってしまうため、
アプリケーション組み込みはできません。<br>
</p>
<p>
また、"nsd_all2.bin"は、VRC6, VRC7, SUNSOFT 5bも同時に仕様する場合に、
0x8000～0xDFFFがROMとなるプレイヤーで、ご使用ください。<br>
この領域がRAMになっていると、暴走します。<br>
</p>
<br>

<table>
<caption>nsd_opll.lib / nsd_opll.bin</caption>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>TR6		</td><td>OPLL FM音源 ch1	</td></tr>
<tr><td>TR7		</td><td>OPLL FM音源 ch2	</td></tr>
<tr><td>TR8		</td><td>OPLL FM音源 ch3	</td></tr>
<tr><td>TR9		</td><td>OPLL FM音源 ch4	</td></tr>
<tr><td>TR10	</td><td>OPLL FM音源 ch5	</td></tr>
<tr><td>TR11	</td><td>OPLL FM音源 ch6	</td></tr>
<tr><td>TR12	</td><td>OPLL FM音源 ch7		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR13	</td><td>OPLL FM音源 ch8		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR14	</td><td>OPLL FM音源 ch9		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR15	</td><td>OPLL Rhythm Bass Drum	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR16	</td><td>OPLL Rhythm Snare Drum	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR17	</td><td>OPLL Rhythm Hi Hat		<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR18	</td><td>OPLL Rhythm Top Cymbal	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR19	</td><td>OPLL Rhythm Tom Tom	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
</table>
<p>
※"nsd_opll.lib" 及び "nsd_opll.bin" は、VRC7をOPLL（YM2413）に換装した、改造拡張音源用の音源ドライバーです。<br>
ファミコン実機でOPLLを鳴らしたい方は、個人の責任にて改造して下さい。<br>
</p>
<p>
ch7～9のFM音源／リズム音源の切り替えは、TR15～19の`s'コマンドにて設定します。<br>
曲中での切り替えにも対応しており、デフォルトは、FM音源 9ch（s0）です。<br>
s0	…	FM音源 9ch	（TR15～19の発音は無効になります。休符を置いてください。）<br>
s1	…	FM音源 6ch + リズム音源 5ch	（TR12～14の発音は無効になります。休符を置いてください。）<br>
</p>
<p>
リズム音源は、以下のディチューン、オクターブ、音程とする事で、データシートに近い音程となります。<br>
又、OPLLのハードウェア的に、Snare DrumとHi Hatは同じ周波数レジスターを使用しており、<br>
Top CymbalとTom Tomも同じ周波数レジスターである点に注意してください。<br>
</p>
<dl>
<dt>Bass Drum	</dt><dd>D-2 o3 a</dd>
<dt>Snare Drum	</dt><dd>D8 o3 b</dd>
<dt>Hi Hat		</dt><dd>D8 o3 b</dd>
<dt>Top Cymbal	</dt><dd>D8 o2 e</dd>
<dt>Tom Tom		</dt><dd>D8 o2 e</dd>
</dl>
<br>

<table>
<caption>nsd_all.bin </caption>
<tr><th>トラック</th><th>音源						</th></tr>
<tr><td>TR6		</td><td>VRC6 パルス波 ch1			</td></tr>
<tr><td>TR7		</td><td>VRC6 パルス波 ch2			</td></tr>
<tr><td>TR8		</td><td>VRC6 鋸波					</td></tr>
<tr><td>TR9		</td><td>OPLL FM音源 ch1			</td></tr>
<tr><td>TR10	</td><td>OPLL FM音源 ch2			</td></tr>
<tr><td>TR11	</td><td>OPLL FM音源 ch3			</td></tr>
<tr><td>TR12	</td><td>OPLL FM音源 ch4			</td></tr>
<tr><td>TR13	</td><td>OPLL FM音源 ch5			</td></tr>
<tr><td>TR14	</td><td>OPLL FM音源 ch6			</td></tr>
<tr><td>TR15	</td><td>OPLL FM音源 ch7		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR16	</td><td>OPLL FM音源 ch8		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR17	</td><td>OPLL FM音源 ch9		<strong>（Rhythmが有効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR18	</td><td>OPLL Rhythm Bass Drum	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR19	</td><td>OPLL Rhythm Snare Drum	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR20	</td><td>OPLL Rhythm Hi Hat		<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR21	</td><td>OPLL Rhythm Top Cymbal	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR22	</td><td>OPLL Rhythm Tom Tom	<strong>（Rhythmが無効な時は、デバイス出力しません）</strong></td></tr>
<tr><td>TR23	</td><td>MMC5 パルス波 ch1			</td></tr>
<tr><td>TR24	</td><td>MMC5 パルス波 ch2			</td></tr>
<tr><td>TR25	</td><td>N163（波形メモリ音源） ch8	</td></tr>
<tr><td>TR26	</td><td>N163（波形メモリ音源） ch7	</td></tr>
<tr><td>TR27	</td><td>N163（波形メモリ音源） ch6	</td></tr>
<tr><td>TR28	</td><td>N163（波形メモリ音源） ch5	</td></tr>
<tr><td>TR29	</td><td>N163（波形メモリ音源） ch4	</td></tr>
<tr><td>TR30	</td><td>N163（波形メモリ音源） ch3	</td></tr>
<tr><td>TR31	</td><td>N163（波形メモリ音源） ch2	</td></tr>
<tr><td>TR32	</td><td>N163（波形メモリ音源） ch1	</td></tr>
<tr><td>TR33	</td><td>Sunsoft 5B ch1				</td></tr>
<tr><td>TR34	</td><td>Sunsoft 5B ch2				</td></tr>
<tr><td>TR35	</td><td>Sunsoft 5B ch3				</td></tr>
<tr><td>TR36	</td><td>制御用トラックです（音符は発音しません）。<br>曲全体のコマンド（テンポや、VRC7, n163の音色設定等）を記述できます。</td></tr>
</table>


<h4>SE記述ブロック</h4>
<p>
効果音は、どのライブラリ(*.lib)、どのＮＳＦ用コード（*.bin）でも同じです。<br>
</p>
<table>
<tr><th>トラック</th><th>音源</th></tr>
<tr><td>1</td><td>APU(2A03) パルス波 ch2	（Default）	</td></tr>
<tr><td>2</td><td>APU(2A03) ノイズ			</td></tr>
</table>


</div>
<!-- ──────────────── -->
<div class='block'>
<h3>内容（Contents）</h3>
<p>
以後のシーケンスデータのトラックを指定します。<br>
</p>
</div>

<!-- ──────────────── -->
<div class='block'>
<h3>注意（Notes）</h3>
<p>
サブルーチン記述ブロックでは無効です。<br>
</p>
<p>
カンマで区切ることにより複数トラックの指定が可能ですが、
指定したトラックの分だけ、曲シーケンスのバイナリを作成するため、
曲データのサイズが肥大化する可能性があります。<br>
同じような曲シーケンスが続く場合、<a href="F:\NSDL\src\help\mml_sub.html">サブルーチン</a>化することにより、曲データの肥大化を防止できます。<br>
</p>
</div>

<!-- ──────────────── -->
<div class='block'>
<h3>例（Sample）</h3>

<code><pre>
BGM(1){
    TR1     l4o4 reee  reee  rfff rddd  e1
    TR2     l4o3 rggg &gt;rccc&lt; raaa rbbb &gt;c1
    TR3     l4o3 c2r2 &lt;a2r2&gt; d2r2 g2r2  c1
}
</pre></code>

</div>


</div>

</BODY>
</HTML>
